#' Make a regular pattern MULTILINESTRING to "fill" an sf POLYGON or MULTIPOLYGON
#'
#' @return Polygon
#' @import sf
#' @export
# version 0.0.1

st_pattern <- function(x, size, pattern) {
  # https://stackoverflow.com/questions/21677489/fill-geospatial-polygons-with-pattern-r
  ex = list(
    horizontal = c(1, 2),
    vertical = c(1, 4),
    left2right = c(2, 4),
    right2left = c(1, 3)
  )
  fillgrid = st_make_grid(x, cellsize = size)
  endsf = lapply(1:length(fillgrid), function(j)
    sf::st_linestring(sf::st_coordinates(fillgrid[j])[ex[[pattern]], 1:2]))
  endsf = sf::st_sfc(endsf, crs = sf::st_crs(x))
  endsf = sf::st_intersection(endsf, x)
  endsf = endsf[sf::st_geometry_type(endsf)
                %in% c("LINESTRING", "MULTILINESTRING")]
  endsf = sf::st_line_merge(sf::st_union(endsf))
  return(endsf)
}

